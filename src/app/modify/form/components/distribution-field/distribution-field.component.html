<div class="distribution-field">
	<div class="ob-flex ob-justify-between ob-items-center ob-ob-mb-3">
		<label class="field-label">
			{{ label | translate }}
			<span *ngIf="required" class="required-asterisk">*</span>
		</label>
		<button type="button" [obButton]="'secondary'" (click)="addDistribution()" size="sm">
			<mat-icon svgIcon="plus">
				<span class="ob-screen-reader-only">Add distribution</span>
			</mat-icon>
			{{ "modify.auth.form.buttons.addDistribution" | translate }}
		</button>
	</div>

	<div *ngIf="distributionsArray.length === 0" class="no-distributions-message">
		<small class="ob-text-muted">{{ "modify.auth.form.messages.noDistributions" | translate }}</small>
	</div>

	<div *ngFor="let distributionGroup of distributionsArray.controls; let i = index" class="distribution-card ob-mb-4 ob-border ob-rounded ob-p-4">
		<div>
			<div class="ob-flex ob-justify-between ob-items-start ob-mb-3">
				<h6 class="ob-mb-0">{{ "modify.auth.form.labels.distribution" | translate }} {{ i + 1 }}</h6>
				<button type="button" [obButton]="'secondary'" (click)="removeDistribution(i)" size="sm" class="ob-text-danger">
					<mat-icon svgIcon="cancel-circle">
						<span class="ob-screen-reader-only">Remove distribution</span>
					</mat-icon>
				</button>
			</div>

			<div [formGroup]="$any(distributionGroup)">
				<!-- Required Fields -->
				<div class="ob-flex ob-flex-wrap ob-gap-4 ob-mb-3">
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:identifier" | translate }} *</mat-label>
							<input matInput formControlName="dct:identifier" [placeholder]="'modify.auth.form.placeholders.distributionId' | translate" (blur)="onBlur()" />
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.adms:status" | translate }} *</mat-label>
							<mat-select formControlName="adms:status" (blur)="onBlur()">
								<mat-option *ngFor="let status of statuses" [value]="status.value">
									{{ status.label }}
								</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:format" | translate }} *</mat-label>
							<input matInput formControlName="dct:format" [placeholder]="'modify.auth.form.placeholders.format' | translate" (blur)="onBlur()" />
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:modified" | translate }}</mat-label>
							<input matInput [matDatepicker]="modifiedPicker" formControlName="dct:modified" />
							<mat-datepicker-toggle matIconSuffix [for]="modifiedPicker"></mat-datepicker-toggle>
							<mat-datepicker #modifiedPicker></mat-datepicker>
						</mat-form-field>
					</div>
				</div>

				<!-- URLs -->
				<div class="ob-flex ob-flex-wrap ob-gap-4 ob-mb-3">
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dcat:accessURL" | translate }} *</mat-label>
							<input
								matInput
								type="url"
								formControlName="dcat:accessURL"
								[placeholder]="'modify.auth.form.placeholders.accessUrl' | translate"
								(blur)="onBlur()"
							/>
							<mat-hint>{{ "modify.auth.form.help.accessUrl" | translate }}</mat-hint>
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dcat:downloadURL" | translate }}</mat-label>
							<input
								matInput
								type="url"
								formControlName="dcat:downloadURL"
								[placeholder]="'modify.auth.form.placeholders.downloadUrl' | translate"
								(blur)="onBlur()"
							/>
							<mat-hint>{{ "modify.auth.form.help.downloadUrl" | translate }}</mat-hint>
						</mat-form-field>
					</div>
				</div>

				<!-- Optional Metadata -->
				<div class="ob-flex ob-flex-wrap ob-gap-4 ob-mb-3">
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:title" | translate }}</mat-label>
							<input matInput formControlName="dct:title" [placeholder]="'modify.auth.form.placeholders.distributionTitle' | translate" (blur)="onBlur()" />
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dcatap:availability" | translate }}</mat-label>
							<mat-select formControlName="dcatap:availability" (blur)="onBlur()">
								<mat-option *ngFor="let availability of availabilities" [value]="availability.value">
									{{ availability.label }}
								</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:license" | translate }}</mat-label>
							<mat-select formControlName="dct:license" (blur)="onBlur()">
								<mat-option *ngFor="let license of licenses" [value]="license.value">
									{{ license.label }}
								</mat-option>
							</mat-select>
						</mat-form-field>
					</div>
				</div>

				<!-- Description & Other Fields -->
				<div class="ob-flex ob-flex-wrap ob-gap-4 ob-mb-3">
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.dct:description" | translate }}</mat-label>
							<textarea
								matInput
								formControlName="dct:description"
								rows="2"
								[placeholder]="'modify.auth.form.placeholders.distributionDescription' | translate"
								(blur)="onBlur()"
							></textarea>
						</mat-form-field>
					</div>
					<div class="ob-flex-1 ob-min-w-0">
						<mat-form-field class="ob-w-full">
							<mat-label>{{ "labels.schema:comment" | translate }}</mat-label>
							<textarea
								matInput
								formControlName="schema:comment"
								rows="2"
								[placeholder]="'modify.auth.form.placeholders.additionalComments' | translate"
								(blur)="onBlur()"
							></textarea>
						</mat-form-field>
					</div>
				</div>

				<!-- Standards -->
				<div class="ob-w-full">
					<mat-form-field class="ob-w-full">
						<mat-label>{{ "labels.dct:conformsTo" | translate }}</mat-label>
						<input matInput formControlName="dct:conformsTo" [placeholder]="'modify.auth.form.placeholders.conformsTo' | translate" (blur)="onBlur()" />
					</mat-form-field>
				</div>
			</div>
		</div>
	</div>

	<div class="field-help" *ngIf="required">
		<small class="ob-text-muted">{{ "modify.auth.form.help.distributionsRequired" | translate }}</small>
	</div>
</div>
