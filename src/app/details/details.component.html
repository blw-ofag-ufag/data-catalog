<!--<pre>{{dataset$ | async | json }}</pre>-->
<!--<pre>{{loading$ | async | json }}</pre>-->

@if (dataset$ | async; as dataset) {
	@if (currentLang$ | async; as lang) {
		<div class="hero-section">
			<div class="header-container">
				<h2 class="main-heading">{{ ["dct:title", dataset["dct:title"]] | translateField }}</h2>
				<div class="floating-actions">
          <button mat-fab color="accent" aria-label="data source on github" (click)="openGitHubFile()">
            <mat-icon svgIcon="git-hub">github</mat-icon>
          </button>
					<button mat-fab color="accent" aria-label="raw data" (click)="openRawJson()">
						<mat-icon svgIcon="file-json">raw</mat-icon>
					</button>
<!--          <a href="/edit" mat-button obButton="primary" type="button">-->
<!--            {{ "ui.editDataset" | translate }}-->
<!--            <mat-icon svgIcon="pen" />-->
<!--          </a>-->
				</div>
			</div>
			<div class="ob-grid">
				<div class="ob-half">
					<p>{{ ["dct:description", dataset["dct:description"]] | translateField }}</p>
					<div class="ob-inline-form">
						<mat-chip>
							<a [routerLink]="['/index']" [queryParams]="datasetFiltered()">
								{{ "ui.dataSet" | translate }}
							</a>
						</mat-chip>
						<mat-chip>
							<a [routerLink]="['/index']" [queryParams]="publisherFiltered(dataset['dct:publisher'])">
								{{ dataset["dct:publisher"] | org }}
							</a>
						</mat-chip>
					</div>
				</div>
				<div class="ob-half">
					<img src="{{ dataset['schema:image'] || 'https://fal.media/files/koala/fu3fHRalAzcHsxBFze10d_dc302f8699ab49ffadb957300e226b94.jpg' }}" width="100%" />
				</div>
			</div>
		</div>
		<div class="ob-grid">
			<div class="ob-span-12">
				<!-- persons -->
				<h3>{{ "details.heading.affiliated" | translate }}</h3>
				<hr />
				@if (dataset["prov:qualifiedAttribution"] && dataset["prov:qualifiedAttribution"].length > 0) {
					<table class="ob-table ob-table-plain">
						<tbody>
							@for (person of dataset["prov:qualifiedAttribution"]; track $index) {
								<tr>
									<td>
										@if (person["prov:agent"]) {
											<admindir-lookup [person]="person"></admindir-lookup>
										} @else {
											<a href="mailto:{{ person['schema:email'] }}">{{ person["schema:name"] }}</a>
										}
									</td>
									<td>
										<mat-chip>{{ person["dcat:hadRole"] }}</mat-chip>
									</td>
								</tr>
							}
						</tbody>
					</table>
				} @else {
					<p class="empty-state">{{ "details.noAffiliatedPersons" | translate }}</p>
				}

				<!-- metadata -->
				<h3>{{ "details.heading.metadata" | translate }}</h3>
				<hr />
				<!--				<div class="meta-container">-->
				<table class="ob-table ob-table-plain">
					<tbody>
						@for (meta of metadata$ | async; track $index) {
							<tr>
								<td>
									{{ "labels." + meta.label | translate }}
								</td>
								<td>
									@if (enumTypes.includes(meta.label) && meta.label !== "dcat:keyword") {
										<enum [label]="meta.label" [data]="meta.data"></enum>
									}
									@if (meta.label === "dcat:keyword") {
										<keywords [keywords]="dataset['dcat:keyword'] || []"></keywords>
									}
									@if (!enumTypes.includes(meta.label) && meta.label !== "dcat:keyword") {
										<metadata-item [label]="meta.label" [data]="meta.data"></metadata-item>
									}
									<!--									<a href="google.com">simple link</a>-->
								</td>
							</tr>
						}
					</tbody>
				</table>

				<!-- distribution -->
				@if (dataset["dcat:distribution"] && dataset["dcat:distribution"].length > 0) {
					<h3>{{ "details.heading.distributions" | translate }}</h3>
					<hr />
					<mat-accordion>
						@for (dist of dataset["dcat:distribution"]; track $index) {
							<mat-expansion-panel>
								<mat-expansion-panel-header>
									<mat-panel-title>
										{{ ["dct:title", dist["dct:title"]] | translateField }}
									</mat-panel-title>
									<mat-panel-description>
										{{ ["dct:description", dist["dct:description"]] | translateField }}
									</mat-panel-description>
								</mat-expansion-panel-header>
								<distribution [distribution]="dist"></distribution>
							</mat-expansion-panel>
						}
					</mat-accordion>
				}

				@if (dataset["bv:externalCatalogs"] && dataset["bv:externalCatalogs"].length > 0) {
					<h3>{{ "details.heading.publications" | translate }}</h3>
					<hr />
					<table class="ob-table ob-table-plain">
						<tbody>
							@for (pub of dataset["bv:externalCatalogs"]; track $index) {
								<tr>
									<td>{{ pub["dcat:catalog"] }}</td>
									<td>{{ pub["dct:identifier"] }}</td>
								</tr>
							}
						</tbody>
					</table>
				}
			</div>
		</div>
	}
} @else {
	@if (loading$ | async) {
		<pre>loading...</pre>
	} @else {
		<app-not-found></app-not-found>
	}
	<!--	<app-not-found *ngIf="!loading$ | async"></app-not-found>-->
}

<!--<p>details for dataset {{ dataset }}</p>-->
<!--<pre>{{dataset$ | async | json}}</pre>-->
<!--<div class="ob-grid">-->
<!--  <div class="ob-span-10">-->
<!--    <h6>Affiliated Persons</h6>-->
<!--    <hr/>-->
<!--    <label for="data-steward">-->
<!--      <a href="#">Andrea Müller</a>-->
<!--    </label>-->
<!--    <div id="data-steward">-->
<!--      <mat-chip>Data Steward</mat-chip>-->
<!--    </div>-->
<!--    <hr/>-->
<!--    <label for="data-steward">-->
<!--      <a href="#">Michael Gysi</a>-->
<!--    </label>-->
<!--    <div id="data-steward">-->
<!--      <mat-chip>Business Data Owner</mat-chip>-->
<!--    </div>-->

<!--    <br>-->
<!--    <h6>Metadata</h6>-->
<!--    <hr/>-->
<!--    <label for="contact-point">-->
<!--      Contact Point-->
<!--    </label>-->
<!--    <div id="contact-point">-->
<!--      Büro für Sortenschutz <a href="#">sortenadmin&#64;blw.admin.ch</a>-->
<!--    </div>-->
<!--    <hr/>-->
<!--    ...-->

<!--    <br>-->
<!--    <h6>Distribution</h6>-->

<!--    <br>-->
<!--    <h6>Publications</h6>-->
<!--    <table class="ob-table">-->
<!--      <thead>-->
<!--      <tr>-->
<!--        <th scope="col">Catalog</th>-->
<!--        <th scope="col">Publications</th>-->
<!--        <th scope="col">Identifier</th>-->
<!--      </tr>-->
<!--      </thead>-->
<!--      <tbody>-->
<!--      <tr>-->
<!--        <td data-title="POSITION">opendata.swiss</td>-->
<!--        <th scope="row" data-title="NAME"><mat-chip>No</mat-chip></th>-->
<!--        <td data-title="WEIGHT"></td>-->
<!--      </tr>-->
<!--      <tr>-->
<!--        <td data-title="POSITION">I14Y</td>-->
<!--        <th scope="row" data-title="NAME"><mat-chip>Yes</mat-chip></th>-->
<!--        <td data-title="WEIGHT"><a href="#">BLW_DS_VARIETIES</a></td>-->
<!--      </tr>-->
<!--      </tbody>-->
<!--      </tbody>-->
<!--    </table>-->

<!--  </div>-->
<!--  <div class="ob-span-2">-->
<!--    <pre>-->
<!--      tbd: Quicknav-->
<!--    </pre>-->
<!--  </div>-->
<!--</div>-->
