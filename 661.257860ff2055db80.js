"use strict";(self.webpackChunkDigiAgriFoodDB=self.webpackChunkDigiAgriFoodDB||[]).push([[661],{4042:(ct,A,n)=>{n.r(A),n.d(A,{diagram:()=>et});var k=n(467),B=n(8530),y=n(5011),U=n(3934),e=n(3721),F=n(4756),g=n(9266),M=e.UI.pie,v={sections:new Map,showData:!1,config:M},u=v.sections,E=v.showData,G=structuredClone(M),b=(0,e.K2)(()=>structuredClone(G),"getConfig"),z=(0,e.K2)(()=>{u=new Map,E=v.showData,(0,e.IU)()},"clear"),j=(0,e.K2)(({label:t,value:a})=>{u.has(t)||(u.set(t,a),e.Rm.debug(`added new section: ${t}, with value: ${a}`))},"addSection"),O={getConfig:b,clear:z,setDiagramTitle:e.ke,getDiagramTitle:e.ab,setAccTitle:e.SV,getAccTitle:e.iN,setAccDescription:e.EI,getAccDescription:e.m7,addSection:j,getSections:(0,e.K2)(()=>u,"getSections"),setShowData:(0,e.K2)(t=>{E=t},"setShowData"),getShowData:(0,e.K2)(()=>E,"getShowData")},Q=(0,e.K2)((t,a)=>{(0,B.S)(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)},"populateDb"),Y={parse:(0,e.K2)(function(){var t=(0,k.A)(function*(a){const _=yield(0,F.qg)("pie",a);e.Rm.debug(_),Q(_,O)});return function(a){return t.apply(this,arguments)}}(),"parse")},H=(0,e.K2)(t=>`\n  .pieCircle{\n    stroke: ${t.pieStrokeColor};\n    stroke-width : ${t.pieStrokeWidth};\n    opacity : ${t.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${t.pieOuterStrokeColor};\n    stroke-width: ${t.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${t.pieTitleTextSize};\n    fill: ${t.pieTitleTextColor};\n    font-family: ${t.fontFamily};\n  }\n  .slice {\n    font-family: ${t.fontFamily};\n    fill: ${t.pieSectionTextColor};\n    font-size:${t.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${t.pieLegendTextColor};\n    font-family: ${t.fontFamily};\n    font-size: ${t.pieLegendTextSize};\n  }\n`,"getStyles"),X=(0,e.K2)(t=>{const a=[...t.entries()].map(s=>({label:s[0],value:s[1]})).sort((s,l)=>l.value-s.value);return(0,g.rLf)().value(s=>s.value)(a)},"createPieArcs"),et={parser:Y,db:O,renderer:{draw:(0,e.K2)((t,a,_,s)=>{e.Rm.debug("rendering pie chart\n"+t);const l=s.db,P=(0,e.D7)(),$=(0,y.$t)(l.getConfig(),P.pie),C=(0,U.D)(a),d=C.append("g");d.attr("transform","translate(225,225)");const{themeVariables:r}=P;let[I]=(0,y.I5)(r.pieOuterStrokeWidth);I??=2;const K=$.textPosition,D=Math.min(450,450)/2-40,at=(0,g.JLW)().innerRadius(0).outerRadius(D),rt=(0,g.JLW)().innerRadius(D*K).outerRadius(D*K);d.append("circle").attr("cx",0).attr("cy",0).attr("r",D+I/2).attr("class","pieOuterCircle");const R=l.getSections(),T=X(R),p=(0,g.UMr)([r.pie1,r.pie2,r.pie3,r.pie4,r.pie5,r.pie6,r.pie7,r.pie8,r.pie9,r.pie10,r.pie11,r.pie12]);d.selectAll("mySlices").data(T).enter().append("path").attr("d",at).attr("fill",i=>p(i.data.label)).attr("class","pieCircle");let W=0;R.forEach(i=>{W+=i}),d.selectAll("mySlices").data(T).enter().append("text").text(i=>(i.data.value/W*100).toFixed(0)+"%").attr("transform",i=>"translate("+rt.centroid(i)+")").style("text-anchor","middle").attr("class","slice"),d.append("text").text(l.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const x=d.selectAll(".legend").data(p.domain()).enter().append("g").attr("class","legend").attr("transform",(i,f)=>"translate(216,"+(22*f-22*p.domain().length/2)+")");x.append("rect").attr("width",18).attr("height",18).style("fill",p).style("stroke",p),x.data(T).append("text").attr("x",22).attr("y",14).text(i=>{const{label:f,value:m}=i.data;return l.getShowData()?`${f} [${m}]`:f});const L=512+Math.max(...x.selectAll("text").nodes().map(i=>i?.getBoundingClientRect().width??0));C.attr("viewBox",`0 0 ${L} 450`),(0,e.a$)(C,450,L,$.useMaxWidth)},"draw")},styles:H}}}]);